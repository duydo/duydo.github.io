<!doctype html><html lang=en dir=auto data-theme=light><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Effective Persistence of Enums in Java: A Deep Dive into Safe and Scalable Design | Duy Do</title><meta name=keywords content="java,jpa,engineering"><meta name=description content="How to persist an enumeration effectively? Here is my experience.
I&rsquo;ll use Wordpress as an example. We all know that every post in Wordpress blog system has a status with possible values: draft, pending-review, published and so on."><meta name=author content="Duy Do"><link rel=canonical href=https://duydo.me/effective-persistence-of-enums-in-java-a-deep-dive-into-safe-and-scalable-design/><link crossorigin=anonymous href=/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css integrity="sha256-NDzEgLn/yPBMy+XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as=style><link rel=icon href=https://duydo.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://duydo.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://duydo.me/favicon-32x32.png><link rel=apple-touch-icon href=https://duydo.me/apple-touch-icon.png><link rel=mask-icon href=https://duydo.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://duydo.me/effective-persistence-of-enums-in-java-a-deep-dive-into-safe-and-scalable-design/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"&&(document.querySelector("html").dataset.theme="dark")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-MWQHCX1NZ9"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-MWQHCX1NZ9")</script><meta property="og:url" content="https://duydo.me/effective-persistence-of-enums-in-java-a-deep-dive-into-safe-and-scalable-design/"><meta property="og:site_name" content="Duy Do"><meta property="og:title" content="Effective Persistence of Enums in Java: A Deep Dive into Safe and Scalable Design"><meta property="og:description" content="How to persist an enumeration effectively? Here is my experience.
I’ll use Wordpress as an example. We all know that every post in Wordpress blog system has a status with possible values: draft, pending-review, published and so on."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2010-01-24T08:17:50+07:00"><meta property="article:modified_time" content="2010-01-24T08:17:50+07:00"><meta property="article:tag" content="Java"><meta property="article:tag" content="Jpa"><meta property="article:tag" content="Engineering"><meta property="og:image" content="https://duydo.me/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://duydo.me/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Effective Persistence of Enums in Java: A Deep Dive into Safe and Scalable Design"><meta name=twitter:description content="How to persist an enumeration effectively? Here is my experience.
I&rsquo;ll use Wordpress as an example. We all know that every post in Wordpress blog system has a status with possible values: draft, pending-review, published and so on."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://duydo.me/posts/"},{"@type":"ListItem","position":2,"name":"Effective Persistence of Enums in Java: A Deep Dive into Safe and Scalable Design","item":"https://duydo.me/effective-persistence-of-enums-in-java-a-deep-dive-into-safe-and-scalable-design/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Effective Persistence of Enums in Java: A Deep Dive into Safe and Scalable Design","name":"Effective Persistence of Enums in Java: A Deep Dive into Safe and Scalable Design","description":"How to persist an enumeration effectively? Here is my experience.\nI\u0026rsquo;ll use Wordpress as an example. We all know that every post in Wordpress blog system has a status with possible values: draft, pending-review, published and so on.\n","keywords":["java","jpa","engineering"],"articleBody":"How to persist an enumeration effectively? Here is my experience.\nI’ll use Wordpress as an example. We all know that every post in Wordpress blog system has a status with possible values: draft, pending-review, published and so on.\nThere are several common ways to model this post entity in a Java application. We could start by simply saving the status as an integer value in the database, where: draft -\u003e 0, pending-review -\u003e 1, published -\u003e 2.\nVersion 1: Using Integers (Simple but Unsafe) @Entity public class Post { private Integer status; public Integer getStatus() { return status; } public void setStatus(Integer status) { this.status = status; } } This works fine, and clients can use it as follows:\nPost post = ...; //Draft post post.setStatus(0); repository.store(post); The problem? This approach is inherently unsafe. Clients can set any arbitrary integer value for the status, leading to invalid data in your database.\nTo improve safety, we might define constants for the status values:\npublic class PostStatus { public static final Integer DRAFT = 0; public static final Integer PENDING_REVIEW = 1; public static final Integer PUBLISHED = 2; } Now, clients can use meaningful names:\nPost post = ...; //Draft post post.setStatus(PostStatus.DRAFT); repository.store(post); However, this is still not robust because it doesn’t enforce the use of the PostStatus class. So, how can we enforce safety?\nThe natural next step is to force clients to use a defined type by declaring PostStatus as an Enum and using it directly in the Post entity.\nVersion 2: Using JPA’s Default @Enumerated (Better, but Fragile) public enum PostStatus { DRAFT, PENDING_REVIEW, PUBLISHED; } @Entity public class Post { @Enumerated private PostStatus status; public PostStatus getStatus() { return status; } public void setStatus(PostStatus status) { this.status = status; } } This is certainly better for code safety. Clients must now use a valid PostStatus enum constant:\nPost post = ...; //Draft post post.setStatus(PostStatus.DRAFT); repository.store(post); But wait… there’s a serious limitation here. By default, JPA persists all enum constants by their ordinal (position), starting from 0. This creates a brittle dependency: You cannot change the order of constants, and you can only safely append a new constant to the end. Any structural change will corrupt your existing database data.\nHow do we solve this limitation while keeping the type safety of an Enum?\nVersion 3: Custom Value Persistence (The Robust Solution) The Enum type in Java 5 is powerful, allowing us to add a constructor and specific business logic. By applying this feature, we can decouple the persisted value from the enum’s ordinal by explicitly defining the stored value.\npublic enum PostStatus { DRAFT(0), PENDING_REVIEW(1), PUBLISHED(2); private final Integer value; private PostStatus(Integer value) { this.value = value; } public Integer getValue() { return value; } } The Post entity is then rewritten to store and retrieve the custom integer value:\n@Entity public class Post { private Integer status; public PostStatus getStatus() { //TODO we need a helper to convert status value to PostStatus enum return ...; } public void setStatus(PostStatus status) { this.status = status.getValue(); } } Excellent!\nNow, the clients use type-safe code, and we can add, reorder, or modify constants in PostStatus without ever worrying about breaking existing database entries.\nThis robust design reminds me of that famous quote from the Java4Ever trailer: “Look how beautiful, robust, secure, portable and scalable it is!”\nTo make Version 3 truly enterprise-grade, consider implementing a custom JPA AttributeConverter. This pattern hides the conversion logic (Integer to Enum and vice versa) away from the Post entity, leading to much cleaner and more maintainable code, especially when dealing with complex data mappings, like those you might encounter when synchronizing data to systems like Elasticsearch.\n","wordCount":"614","inLanguage":"en","image":"https://duydo.me/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2010-01-24T08:17:50+07:00","dateModified":"2010-01-24T08:17:50+07:00","author":{"@type":"Person","name":"Duy Do"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://duydo.me/effective-persistence-of-enums-in-java-a-deep-dive-into-safe-and-scalable-design/"},"publisher":{"@type":"Organization","name":"Duy Do","logo":{"@type":"ImageObject","url":"https://duydo.me/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://duydo.me/ accesskey=h title="Duy Do (Alt + H)">Duy Do</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://duydo.me/archives/ title=Archives><span>Archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Effective Persistence of Enums in Java: A Deep Dive into Safe and Scalable Design</h1><div class=post-meta><span title='2010-01-24 08:17:50 +0700 +07'>Jan 24, 2010</span>&nbsp;·&nbsp;<span>Duy Do</span></div></header><div class=post-content><p>How to persist an enumeration effectively? Here is my experience.</p><p>I&rsquo;ll use Wordpress as an example. We all know that every post in Wordpress blog system has a status with possible values: <code>draft</code>, <code>pending-review</code>, <code>published</code> and so on.</p><p>There are several common ways to model this post entity in a Java application. We could start by simply saving the status as an integer value in the database, where: <code>draft -> 0</code>, <code>pending-review -> 1</code>, <code>published -> 2</code>.</p><h3 id=version-1-using-integers-simple-but-unsafe>Version 1: Using Integers (Simple but Unsafe)<a hidden class=anchor aria-hidden=true href=#version-1-using-integers-simple-but-unsafe>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Post</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>status</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=nf>getStatus</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=n>status</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>setStatus</span><span class=p>(</span><span class=n>Integer</span><span class=w> </span><span class=n>status</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>this</span><span class=p>.</span><span class=na>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>status</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>This works fine, and clients can use it as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Post</span><span class=w> </span><span class=n>post</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>...;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=c1>//Draft post</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>post</span><span class=p>.</span><span class=na>setStatus</span><span class=p>(</span><span class=n>0</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>repository</span><span class=p>.</span><span class=na>store</span><span class=p>(</span><span class=n>post</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>The problem? This approach is inherently unsafe. Clients can set any arbitrary integer value for the status, leading to invalid data in your database.</p><p>To improve safety, we might define constants for the status values:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>PostStatus</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>DRAFT</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>PENDING_REVIEW</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>1</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>PUBLISHED</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>2</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Now, clients can use meaningful names:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=n>Post</span><span class=w> </span><span class=n>post</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>...;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//Draft post</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>post</span><span class=p>.</span><span class=na>setStatus</span><span class=p>(</span><span class=n>PostStatus</span><span class=p>.</span><span class=na>DRAFT</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>repository</span><span class=p>.</span><span class=na>store</span><span class=p>(</span><span class=n>post</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>However, this is still not robust because it doesn&rsquo;t enforce the use of the <code>PostStatus</code> class. So, how can we enforce safety?</p><p>The natural next step is to force clients to use a defined type by declaring <code>PostStatus</code> as an <code>Enum</code> and using it directly in the Post entity.</p><h3 id=version-2-using-jpas-default-enumerated-better-but-fragile>Version 2: Using JPA&rsquo;s Default @Enumerated (Better, but Fragile)<a hidden class=anchor aria-hidden=true href=#version-2-using-jpas-default-enumerated-better-but-fragile>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>enum</span><span class=w> </span><span class=n>PostStatus</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>DRAFT</span><span class=p>,</span><span class=w> </span><span class=n>PENDING_REVIEW</span><span class=p>,</span><span class=w> </span><span class=n>PUBLISHED</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Post</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Enumerated</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=n>PostStatus</span><span class=w> </span><span class=n>status</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>PostStatus</span><span class=w> </span><span class=nf>getStatus</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=n>status</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>setStatus</span><span class=p>(</span><span class=n>PostStatus</span><span class=w> </span><span class=n>status</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>this</span><span class=p>.</span><span class=na>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>status</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>This is certainly better for code safety. Clients must now use a valid <code>PostStatus</code> enum constant:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=n>Post</span><span class=w> </span><span class=n>post</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>...;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>//Draft post</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>post</span><span class=p>.</span><span class=na>setStatus</span><span class=p>(</span><span class=n>PostStatus</span><span class=p>.</span><span class=na>DRAFT</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>repository</span><span class=p>.</span><span class=na>store</span><span class=p>(</span><span class=n>post</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>But wait&mldr; there&rsquo;s a serious limitation here. By default, JPA persists all enum constants by their ordinal (position), starting from 0. This creates a brittle dependency: You cannot change the order of constants, and you can only safely append a new constant to the end. Any structural change will corrupt your existing database data.</p><p>How do we solve this limitation while keeping the type safety of an <code>Enum</code>?</p><h3 id=version-3-custom-value-persistence-the-robust-solution>Version 3: Custom Value Persistence (The Robust Solution)<a hidden class=anchor aria-hidden=true href=#version-3-custom-value-persistence-the-robust-solution>#</a></h3><p>The <code>Enum</code> type in Java 5 is powerful, allowing us to add a constructor and specific business logic. By applying this feature, we can decouple the persisted value from the enum&rsquo;s ordinal by explicitly defining the stored value.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>enum</span><span class=w> </span><span class=n>PostStatus</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>DRAFT</span><span class=p>(</span><span class=n>0</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>PENDING_REVIEW</span><span class=p>(</span><span class=n>1</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=n>PUBLISHED</span><span class=p>(</span><span class=n>2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=kd>final</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>value</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=nf>PostStatus</span><span class=p>(</span><span class=n>Integer</span><span class=w> </span><span class=n>value</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>this</span><span class=p>.</span><span class=na>value</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>value</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=nf>getValue</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=n>value</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>The <code>Post</code> entity is then rewritten to store and retrieve the custom integer value:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=nd>@Entity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>Post</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>status</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=n>PostStatus</span><span class=w> </span><span class=nf>getStatus</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=c1>//TODO we need a helper to convert status value to PostStatus enum</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>return</span><span class=w> </span><span class=p>...;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>setStatus</span><span class=p>(</span><span class=n>PostStatus</span><span class=w> </span><span class=n>status</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>this</span><span class=p>.</span><span class=na>status</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>status</span><span class=p>.</span><span class=na>getValue</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Excellent!</p><p>Now, the clients use type-safe code, and we can add, reorder, or modify constants in PostStatus without ever worrying about breaking existing database entries.</p><p>This robust design reminds me of that famous quote from the Java4Ever trailer: &ldquo;Look how beautiful, robust, secure, portable and scalable it is!&rdquo;</p><p>To make Version 3 truly enterprise-grade, consider implementing a custom JPA AttributeConverter. This pattern hides the conversion logic (Integer to Enum and vice versa) away from the Post entity, leading to much cleaner and more maintainable code, especially when dealing with complex data mappings, like those you might encounter when synchronizing data to systems like Elasticsearch.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://duydo.me/tags/java/>Java</a></li><li><a href=https://duydo.me/tags/jpa/>Jpa</a></li><li><a href=https://duydo.me/tags/engineering/>Engineering</a></li></ul><nav class=paginav><a class=prev href=https://duydo.me/how-elasticsearch-cluster-works/><span class=title>« Prev</span><br><span>How Elasticsearch cluster works</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://duydo.me/>Duy Do</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>